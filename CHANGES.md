# ุณุฌู ุงูุชุบููุฑุงุช (Changelog)

ุฌููุน ุงูุชุบููุฑุงุช ุงููุงูุฉ ูู ูุฐุง ุงูุจูุช ุณูุชู ุชูุซูููุง ูู ูุฐุง ุงูููู.

---

## [1.0.2] - 2026-01-13

### ุงูุฅุตูุงุญุงุช (Bug Fixes)
- โ **ุฅุตูุงุญ ูุดููุฉ ุญุณุงุจ ุงูุชุงุฑูุฎ ููููุงุทู ุงูุฒูููุฉ ุงููุฎุชููุฉ**:
  - ุชุญุณูู ุฏุงูุฉ `fetch_and_save_prayer_times()` ูุญุณุงุจ ุงูุชุงุฑูุฎ ุจูุงุกู ุนูู timezone ูู ูุฌููุนุฉ
  - ุนูุฏ ูุฌูุฏ cache hitุ ูุชู ุงูุขู ุงุณุชุฎุฏุงู timezone ุงููุฌููุนุฉ ูุชุญุฏูุฏ "ุงูููู" ุงูุตุญูุญ
  - ูููุน ูุดููุฉ ุฅุฑุณุงู ุฃููุงุช ุตูุงุฉ ูููู ุฎุงุทุฆ ูููุฌููุนุงุช ูู ููุงุทู ุฒูููุฉ ูุฎุชููุฉ

- โ **ุฅุตูุงุญ ูุดููุฉ ุงูุจูุช ุงููุทุฑุฏ ูู ุงููุฌููุนุงุช**:
  - ุฅุถุงูุฉ ูุนุงูุฌุฉ ุฐููุฉ ููุฎุทุฃ 403 ูู Telegram API
  - ุนูุฏ ุทุฑุฏ ุงูุจูุช ูู ูุฌููุนุฉุ ูุชู ุญุฐู ุจูุงูุงุช ุงููุฌููุนุฉ ููุฑุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
  - ูููุน ุชูุฑุงุฑ ูุญุงููุงุช ุงูุฅุฑุณุงู ุงููุงุดูุฉ ูุชุฑุงูู ุงูุฃุฎุทุงุก

- โ **ุฅุตูุงุญ ูุดููุฉ ุชูุฑุงุฑ ุฑุณุงุฆู ุงูุณุฌู (Logging)**:
  - ุฅุถุงูุฉ ููุฏ ููุณุญ handlers ุงูููุฌูุฏุฉ ูุณุจูุงู ูุจู ุฅุถุงูุฉ handlers ุฌุฏูุฏุฉ
  - ูููุน ุชูุฑุงุฑ ุงูุณุฌูุงุช ุนูุฏ ุฅุนุงุฏุฉ ุชุดุบูู ุงูุจูุช ุฃู ุฅุนุงุฏุฉ ุชุญููู ุงูููุฏ

- โ **ุฅุตูุงู ูุดููุฉ CPU Usage ุงูุนุงูู**:
  - ุฅุถุงูุฉ sleep ูุฏุฉ 30 ุซุงููุฉ ูู ููุงูุฉ ุญููุงุช ุงููุฌุฏูู
  - ุชุญุณูู azan_scheduler_loop ู content_scheduler_loop ูุชูููู ุงูุงุณุชููุงู

- โ **ุฅุตูุงู ูุดููุฉ ุชุณุฌูู ุงูุงุณุชุซูุงุกุงุช ุงูุฒุงุฆุฏุฉ**:
  - ุชูููู ุงุณุชุฎุฏุงู `exc_info=True` ุฅูู ุงูุถุฑูุฑู ููุท
  - ุชุญุณูู ุฑุณุงุฆู ุงูุฎุทุฃ ูุชููู ุฃูุซุฑ ูุถูุญุงู

### ุงูุชุญุณููุงุช (Enhancements)
- โ **ูุธุงู ุงูุณุฌูุงุช ุงููุทูุฑ ุจุงููุงูู (Enhanced Logging System)**:
  - ุงุณุชุจุฏุงู `logging.basicConfig()` ุงูุจุณูุท ุจูุธุงู logging ูุชูุฏู
  - **Root Logger** (ุงูุฃุณุงุณ): ูุณูุญ ุจูุฑูุฑ ุฌููุน ุงููุณุชููุงุช (DEBUG ูุฃุนูู)
  - **File Handler ูุฎุตุต**:
    - ูุญูุธ ุงูุณุฌูุงุช ูู ููู `bot_debug.log` ุจุฏูุงู ูู `bot.log`
    - ูุณุชุฎุฏู encoding UTF-8 ูุฏุนู ุงููุบุฉ ุงูุนุฑุจูุฉ
    - ููุชูุท ุฌููุน ุงููุณุชููุงุช ูู DEBUG ุฅูู CRITICAL
    - ููุฑูุงุช ููุตู: ุงูุชุงุฑูุฎ | ุงููุณุชูู | ุงูููู:ุงูุณุทุฑ | ุงูุฑุณุงูุฉ

  - **Console Handler ูุน ููุชุฑ ูุฎุตุต**:
    - ูุฆุฉ `ConsoleFilter` ุฌุฏูุฏุฉ ูุชูููู ุงูุถูุถุงุก ูู ุงูุชูุฑููู
    - ูุนุฑุถ ููุท ุงูุฑุณุงุฆู ุงููููุฉ (INFO, WARNING, ERROR, CRITICAL)
    - ูุฎูู ุฑุณุงุฆู DEBUG ูู ุงูุชูุฑููู ูุชุฌูุจ ุงูุฅุฑุจุงู
    - ููุฑูุงุช ุจุณูุท: `LEVEL: message` ุจุฏูู ุชุงุฑูุฎ ูุชูุงุตูู ูุนูุฏุฉ

  - **Logger ุฎุงุต ุจุงูุชุทุจูู**:
    - ุงุณู logger: `'IslamicPrayerBot'` ุจุฏูุงู ูู `__name__`
    - ุฑุณุงูุฉ ุงุฎุชุจุงุฑ ุนูุฏ ุงูุชุดุบูู ููุชุฃูุฏ ูู ุนูู ุงููุธุงู
    - ุฑุณุงุฆู emoji ููุชูููุฒ ุงูุณุฑูุน

- โ **ุงุณุชูุฑุงุฏุงุช ุฌุฏูุฏุฉ**:
  - ุฅุถุงูุฉ `from telebot.apihelper import ApiTelegramException` ููุชุนุงูู ูุน ุฃุฎุทุงุก Telegram
  - ุฅุถุงูุฉ `from pathlib import Path` ูุฅูุดุงุก ูุฌูุฏุงุช ุงูุณุฌูุงุช ุจุดูู ุขูู

- โ **ุชุญุณูู ูุนุงูุฌุฉ ุงูููุทูุฉ ุงูุฒูููุฉ (Timezone Handling)**:
  - ุชุญุณูู ุฏุงูุฉ `fetch_and_save_prayer_times()` ูุญุณุงุจ ุงูุชุงุฑูุฎ ุจูุงุกู ุนูู timezone ูู ูุฌููุนุฉ
  - ุนูุฏ cache hitุ ูุชู ุงุณุชุฎุฏุงู timezone ุงููุฌููุนุฉ ูุชุญุฏูุฏ "ุงูููู" ุงูุตุญูุญ
  - ุฅุถุงูุฉ fallback ููุชุงุฑูุฎ ุงููุญูู ุฅุฐุง ูุดู timezone
  - ุงููุฌููุนุงุช ูู ููุงุทู ุฒูููุฉ ูุฎุชููุฉ ุชุญุตู ุนูู ุฃููุงุช ุตูุงุฉ ุตุญูุญุฉ

- โ **ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก (Error Handling)**:
  - ุชุญุณูู ุฏุงูุฉ `send_azan_notification()`:
    - ุฅุถุงูุฉ ูุนุงูุฌุฉ ุฎุงุตุฉ ูู `ApiTelegramException`
    - ุงุณุชุฎุฑุงุฌ error_code ู description ูู ุงูุงุณุชุซูุงุกุงุช
    - ุฅุฐุง ูุงู error_code == 403 ุฃู ูุญุชูู ุนูู 'kicked'/'blocked':
      - ุชุณุฌูู ุชุญุฐูุฑ ูุงุถุญ
      - ุญุฐู ุจูุงูุงุช ุงููุฌููุนุฉ ููุฑุงู ุจุงุณุชุฎุฏุงู `reset_group_data(chat_id)`
      - ููุน ุชูุฑุงุฑ ุงููุญุงููุงุช ุงููุงุดูุฉ
    - ููุฃุฎุทุงุก ุงูุฃุฎุฑู: ุชุณุฌูู ุฎุทุฃ ููุตู ูุน emojis

- โ **ุชุญุณูู ุฏูุงู ุงููุฌุฏูู (Scheduler Functions)**:
  - ุชุญุณูู `azan_scheduler_loop()`:
    - ุฅุฒุงูุฉ ุญุณุงุจ `today` ูู ุฎุงุฑุฌ ุญููุฉ ุงููุฌููุนุงุช
    - ุฅุถุงูุฉ ูุนุงูุฌุฉ ุงุณุชุซูุงุกุงุช ูู timezone
    - ุญุณุงุจ `today` ุฏุงุฎู ุญููุฉ ุงููุฌููุนุงุช ุจูุงุกู ุนูู timezone ูู ูุฌููุนุฉ
    - ุฅุถุงูุฉ sleep 30 ุซุงููุฉ ูู ููุงูุฉ ุงูุญููุฉ
    - ุฅุถุงูุฉ sleep 5 ุซูุงูู ุฅุฐุง ุชุญุทูุช ุงูุญููุฉ ุงูุฑุฆูุณูุฉ

  - ุชุญุณูู `content_scheduler_loop()`:
    - ุญุณุงุจ `today` ุฏุงุฎู ุญููุฉ ุงููุฌููุนุงุช ุจูุงุกู ุนูู timezone
    - ุชูููู window_minutes ุฅูู 1 ุฏูููุฉ ุจุฏูุงู ูู 2
    - ุชุจุณูุท ููุทู ุงูุชุญูู ูู ุงูููุช
    - ุฅุถุงูุฉ sleep 30 ุซุงููุฉ ูู ููุงูุฉ ุงูุญููุฉ

- โ **ุชุญุณููุงุช ูู ุงูููุฏ (Code Quality)**:
  - ุชุจุณูุท ุงูููุฏ: ุฏูุฌ ูุงููุณ prayer_names_arabic ูู ุณุทุฑ ูุงุญุฏ
  - ุฅุฒุงูุฉ ุงููุต "ุงุณุชุฎุฏู ุฒุฑ ๐ ูุงุญูุงู ูุชุณุฌูู ุตูุงุชู!" ูู ุฑุณุงูุฉ ุงูุฃุฐุงู
  - ุชุญุณูู ุงูุชุนูููุงุช: ุฅุถุงูุฉ ุชุนูููุงุช ุนุฑุจูุฉ ุชูุถูุญูุฉ
  - ุชุญุณูู ุฑุณุงุฆู ุงูุณุฌู ุจุงูู Emojis ููุชูููุฒ ุงูุณุฑูุน

- โ **ุชุญุณูู ุฑุณุงุฆู ุงูุณุฌู ุจุงูู Emojis**:
  - ๐ ููุฑุณุงุฆู ุงูุชุดุบูููุฉ
  - โ ูููุฌุงุญ
  - โ ููุฃุฎุทุงุก ุงูุนุงูุฉ
  - โ๏ธ ููุชุญุฐูุฑุงุช
  - ๐ซ ููุญุธุฑ/ุงูุทุฑุฏ
  - ๐ ููุตูุงุฉ
  - ๐ง ูููุญุชูู

### ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ (New Features)
- โ **ุฃูุฑ ุชุฌุฑูุจู `/test_azan`**:
  - ุฃูุฑ ุชุฌุฑูุจู ูููุดุฑููู ูุงุฎุชุจุงุฑ ุฅุฑุณุงู ุงูุฃุฐุงู
  - ูุนูู ููุท ูู ุงููุฌููุนุงุช (group, supergroup)
  - ูุฑุณู ุฑุณุงูุฉ ุชุฌุฑูุจูุฉ ูุตูุงุฉ ุงูุธูุฑ
  - ูุนุฑุถ ุฑุณุงูุฉ ูุฌุงุญ ุฃู ูุดู ูุงุถุญุฉ ูููุณุชุฎุฏู
  - ูุณุงุนุฏ ูู ุชุดุฎูุต ูุดุงูู ุฅุฑุณุงู ุงูุฑุณุงุฆู

- โ **ูุฆุฉ `ConsoleFilter` ุงูุฌุฏูุฏุฉ**:
  - ูุฆุฉ ูุฎุตุตุฉ ุชุฑุซ ูู `logging.Filter`
  - ุชุณูุญ ููุท ุจุงูุฑุณุงุฆู INFO ููุง ููู
  - ุชููู ุงูุถูุถุงุก ูู ุงูุชูุฑููู

### ุงูุชุบููุฑุงุช (Changes)
- โ **ุชุบููุฑ ุฑูู ุงูุฅุตุฏุงุฑ**:
  - ูู `Version: 1.0.1 (Cleaned)` ุฅูู `Version: 1.0.2 (Enhanced Logging)`

- โ **ุชุบููุฑ ูููุฉ BOT_TOKEN ุงูุงูุชุฑุงุถูุฉ**:
  - ูู `'YOUR_BOT_TOKEN_HERE'` ุฅูู `''` (ุณูุณูุฉ ูุงุฑุบุฉ)
  - ููุฑุถ ุนูู ุงููุณุชุฎุฏู ุชุนููู BOT_TOKEN ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ

- โ **ุชุบููุฑ ุงุณู ููู ุงูุณุฌู**:
  - ูู `bot.log` ุฅูู `bot_debug.log`
  - ุงูุงุณู ุงูุฌุฏูุฏ ุฃูุซุฑ ูุถูุญุงู ุญูู ูุญุชูู ุงูููู

- โ **ุชุบููุฑ ุงุณู Logger**:
  - ูู `logger = logging.getLogger(__name__)` ุฅูู `logger = logging.getLogger('IslamicPrayerBot')`
  - ุงุณู logger ูุญุฏุฏ ููุงุถุญ ุจุฏูุงู ูู ุงุณุชุฎุฏุงู `__name__`

- โ **ุชุบููุฑ ูุณุชูู logging ููููู**:
  - ูู `logging.INFO` ุฅูู `logging.DEBUG`
  - ููุชูุท ุฃุฏู ุงูุชูุงุตูู ููุชุดุฎูุต

- โ **ุชุบููุฑ window_minutes ูููุญุชูู**:
  - ูู `CONTENT_WINDOW_MINUTES = 2` ุฅูู ุตุฑูุญ `1` ูู ุงูููุฏ
  - ุชูููู ูุงูุฐุฉ ุงูุฅุฑุณุงู ูุชุญุณูู ุงูุฏูุฉ

### ุงูุฅุฒุงูุฉ (Removals)
- โ **ุฅุฒุงูุฉ `logging.basicConfig()` ุงูุจุณูุท**:
  - ุชู ุงุณุชุจุฏุงูู ุจูุธุงู logging ูุชูุฏู (81 ุณุทุฑ ุฌุฏูุฏ)

- โ **ุฅุฒุงูุฉ ุงููุต "ุงุณุชุฎุฏู ุฒุฑ ๐ ูุงุญูุงู ูุชุณุฌูู ุตูุงุชู!"**:
  - ุชู ุฅุฒุงูุฉ ูุฐุง ุงููุต ูู ุฑุณุงูุฉ ุงูุฃุฐุงู

- โ **ุฅุฒุงูุฉ ุจุนุถ ุฑุณุงุฆู ุงูุณุฌู ุงูุฒุงุฆุฏุฉ**:
  - ุฅุฒุงูุฉ `exc_info=True` ูู ุจุนุถ ุฃูุงูู ุงูุฎุทุฃ ูุชุฌูุจ ุงูุชูุฑุงุฑ
  - ุฅุฒุงูุฉ ุงูุณุทุฑ "Content scheduler loop stopped gracefully"

### ุงููููุงุช ุงููุนุฏูุฉ
- `bot.py` - ุงูููู ุงูุฑุฆูุณู ูุน ุฌููุน ุงูุชุญุณููุงุช

### ุงูุชูุซูู
- โ **ุชุนูููุงุช ูุญุณูุฉ ุจุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ**:
  - ุชูุถูุญ ุงูุบุฑุถ ูู ูู ุฏุงูุฉ
  - ุดุฑุญ ุงูุชุบููุฑุงุช ุงููููุฉ
  - ุชุนูููุงุช ุชูุถูุญูุฉ ุฏุงุฎู ุงูููุฏ

- โ **ุชุญููู ุดุงูู ููุชุบููุฑุงุช**:
  - ููู `CHANGELOG_DETAILED.md` ูุญุชูู ุนูู ุชุญููู ุชูุตููู ููู ุชุบููุฑ
  - ุฅุญุตุงุฆูุงุช ูุงููุฉ ุนู ุงูุชุบููุฑุงุช
  - ุชูุฒูุน ุงูุชุบููุฑุงุช ุญุณุจ ุงููุฆุฉ
